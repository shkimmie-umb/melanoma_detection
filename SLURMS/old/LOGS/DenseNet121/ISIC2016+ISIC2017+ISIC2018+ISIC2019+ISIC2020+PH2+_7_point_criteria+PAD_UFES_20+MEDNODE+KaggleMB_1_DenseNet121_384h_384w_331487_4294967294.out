Wed 01 May 2024 11:32:55 PM EDT
Python 3.9.7
nvcc: NVIDIA (R) Cuda compiler driver
Copyright (c) 2005-2019 NVIDIA Corporation
Built on Sun_Jul_28_19:07:16_PDT_2019
Cuda compilation tools, release 10.1, V10.1.243
My SLURM_ARRAY_TASK_ID: 
DB: ['ISIC2016', 'ISIC2017', 'ISIC2018', 'ISIC2019', 'ISIC2020', 'PH2', '_7_point_criteria', 'PAD_UFES_20', 'MEDNODE', 'KaggleMB']
IMG_SIZE: [384, 384]
CLASSIFIER: DenseNet121
JOB_INDEX: None
Start training augmented images
Combining...
Combining 1th db out of 10 dbs
Combining 2th db out of 10 dbs
Combining 3th db out of 10 dbs
Combining 4th db out of 10 dbs
Combining 5th db out of 10 dbs
Combining 6th db out of 10 dbs
Combining 7th db out of 10 dbs
Combining 8th db out of 10 dbs
Combining 9th db out of 10 dbs
Combining 10th db out of 10 dbs
Stacking data
Combining complete
Model: "sequential"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
densenet121 (Functional)     (None, 1024)              7037504   
_________________________________________________________________
dense (Dense)                (None, 512)               524800    
_________________________________________________________________
dropout (Dropout)            (None, 512)               0         
_________________________________________________________________
batch_normalization (BatchNo (None, 512)               2048      
_________________________________________________________________
dense_1 (Dense)              (None, 256)               131328    
_________________________________________________________________
batch_normalization_1 (Batch (None, 256)               1024      
_________________________________________________________________
dense_2 (Dense)              (None, 2)                 514       
=================================================================
Total params: 7,697,218
Trainable params: 658,178
Non-trainable params: 7,039,040
_________________________________________________________________
Fitting ISIC2016+ISIC2017+ISIC2018+ISIC2019+ISIC2020+PH2+_7_point_criteria+PAD_UFES_20+MEDNODE+KaggleMB_aug_DenseNet121_384h_384w_None model...
model_name: ISIC2016+ISIC2017+ISIC2018+ISIC2019+ISIC2020+PH2+_7_point_criteria+PAD_UFES_20+MEDNODE+KaggleMB_aug_DenseNet121_384h_384w_None
Epoch: 1 loss: 0.7400 accuracy: 0.8326 val_loss: 0.6233 val_accuracy: 0.8725
Epoch: 2 loss: 0.5741 accuracy: 0.8769 val_loss: 0.5431 val_accuracy: 0.8888
Epoch: 3 loss: 0.5097 accuracy: 0.8906 val_loss: 0.5031 val_accuracy: 0.8922
Epoch: 4 loss: 0.4617 accuracy: 0.9011 val_loss: 0.4662 val_accuracy: 0.8958
Epoch: 5 loss: 0.4255 accuracy: 0.9072 val_loss: 0.4430 val_accuracy: 0.8964
Epoch: 6 loss: 0.3905 accuracy: 0.9139 val_loss: 0.4526 val_accuracy: 0.8845
Epoch: 7 loss: 0.3702 accuracy: 0.9175 val_loss: 0.3901 val_accuracy: 0.9180
Epoch: 8 loss: 0.3483 accuracy: 0.9215 val_loss: 0.3882 val_accuracy: 0.9063
Epoch: 9 loss: 0.3289 accuracy: 0.9257 val_loss: 0.3972 val_accuracy: 0.8926
Epoch: 10 loss: 0.3134 accuracy: 0.9276 val_loss: 0.3704 val_accuracy: 0.9054
Epoch: 11 loss: 0.3009 accuracy: 0.9296 val_loss: 0.3473 val_accuracy: 0.9146
Epoch: 12 loss: 0.2854 accuracy: 0.9320 val_loss: 0.3287 val_accuracy: 0.9179
Epoch: 13 loss: 0.2723 accuracy: 0.9348 val_loss: 0.3487 val_accuracy: 0.9076
Epoch: 14 loss: 0.2601 accuracy: 0.9381 val_loss: 0.3492 val_accuracy: 0.9028
Epoch: 15 loss: 0.2489 accuracy: 0.9404 val_loss: 0.3280 val_accuracy: 0.9112
Epoch: 16 loss: 0.2387 accuracy: 0.9428 val_loss: 0.3066 val_accuracy: 0.9191
Epoch: 17 loss: 0.2363 accuracy: 0.9426 val_loss: 0.3150 val_accuracy: 0.9118
Epoch: 18 loss: 0.2279 accuracy: 0.9448 val_loss: 0.3160 val_accuracy: 0.9124
Epoch: 19 loss: 0.2209 accuracy: 0.9461 val_loss: 0.3136 val_accuracy: 0.9133
Epoch: 20 loss: 0.2192 accuracy: 0.9463 val_loss: 0.2918 val_accuracy: 0.9269
Epoch: 21 loss: 0.2110 accuracy: 0.9499 val_loss: 0.3046 val_accuracy: 0.9151
Epoch: 22 loss: 0.2099 accuracy: 0.9491 val_loss: 0.2955 val_accuracy: 0.9181
Epoch: 23 loss: 0.2022 accuracy: 0.9504 val_loss: 0.2910 val_accuracy: 0.9243
Epoch: 24 loss: 0.1982 accuracy: 0.9513 val_loss: 0.3012 val_accuracy: 0.9201
Epoch: 25 loss: 0.1932 accuracy: 0.9537 val_loss: 0.2858 val_accuracy: 0.9227
Epoch: 26 loss: 0.1907 accuracy: 0.9529 val_loss: 0.2875 val_accuracy: 0.9174
Epoch: 27 loss: 0.1849 accuracy: 0.9550 val_loss: 0.2786 val_accuracy: 0.9315
Epoch: 28 loss: 0.1813 accuracy: 0.9557 val_loss: 0.2869 val_accuracy: 0.9235
Epoch: 29 loss: 0.1783 accuracy: 0.9558 val_loss: 0.2867 val_accuracy: 0.9235
Epoch: 30 loss: 0.1785 accuracy: 0.9557 val_loss: 0.2725 val_accuracy: 0.9284
Epoch: 31 loss: 0.1728 accuracy: 0.9584 val_loss: 0.2769 val_accuracy: 0.9239
Epoch: 32 loss: 0.1721 accuracy: 0.9578 val_loss: 0.2860 val_accuracy: 0.9245
Epoch: 33 loss: 0.1710 accuracy: 0.9582 val_loss: 0.2883 val_accuracy: 0.9196
Epoch: 34 loss: 0.1682 accuracy: 0.9590 val_loss: 0.2716 val_accuracy: 0.9262
Epoch: 35 loss: 0.1655 accuracy: 0.9594 val_loss: 0.2765 val_accuracy: 0.9295
Epoch: 36 loss: 0.1669 accuracy: 0.9584 val_loss: 0.2724 val_accuracy: 0.9307
Epoch: 37 loss: 0.1622 accuracy: 0.9611 val_loss: 0.2717 val_accuracy: 0.9228
Epoch: 38 loss: 0.1601 accuracy: 0.9618 val_loss: 0.2943 val_accuracy: 0.9170
Epoch: 39 loss: 0.1623 accuracy: 0.9600 val_loss: 0.2600 val_accuracy: 0.9320
Epoch: 40 loss: 0.1599 accuracy: 0.9602 val_loss: 0.2673 val_accuracy: 0.9283
Epoch: 41 loss: 0.1539 accuracy: 0.9624 val_loss: 0.2850 val_accuracy: 0.9240
Epoch: 42 loss: 0.1504 accuracy: 0.9642 val_loss: 0.2846 val_accuracy: 0.9215
Epoch: 43 loss: 0.1499 accuracy: 0.9642 val_loss: 0.2831 val_accuracy: 0.9209
Epoch: 44 loss: 0.1490 accuracy: 0.9650 val_loss: 0.2916 val_accuracy: 0.9199

Epoch 00044: ReduceLROnPlateau reducing learning rate to 7.999999797903001e-05.
Epoch: 45 loss: 0.1411 accuracy: 0.9677 val_loss: 0.2719 val_accuracy: 0.9287
Epoch: 46 loss: 0.1385 accuracy: 0.9684 val_loss: 0.2633 val_accuracy: 0.9298
Epoch: 47 loss: 0.1327 accuracy: 0.9703 val_loss: 0.2707 val_accuracy: 0.9262
Epoch: 48 loss: 0.1308 accuracy: 0.9707 val_loss: 0.2645 val_accuracy: 0.9350
Epoch: 49 loss: 0.1310 accuracy: 0.9704 val_loss: 0.2515 val_accuracy: 0.9363
Epoch: 50 loss: 0.1268 accuracy: 0.9719 val_loss: 0.2596 val_accuracy: 0.9353
Epoch: 51 loss: 0.1261 accuracy: 0.9720 val_loss: 0.2647 val_accuracy: 0.9301
Epoch: 52 loss: 0.1231 accuracy: 0.9726 val_loss: 0.2719 val_accuracy: 0.9291
Epoch: 53 loss: 0.1251 accuracy: 0.9723 val_loss: 0.2532 val_accuracy: 0.9370
Epoch: 54 loss: 0.1266 accuracy: 0.9715 val_loss: 0.2705 val_accuracy: 0.9307

Epoch 00054: ReduceLROnPlateau reducing learning rate to 6.399999838322402e-05.
Epoch: 55 loss: 0.1147 accuracy: 0.9767 val_loss: 0.2558 val_accuracy: 0.9363
Epoch: 56 loss: 0.1137 accuracy: 0.9763 val_loss: 0.2551 val_accuracy: 0.9391
Epoch: 57 loss: 0.1120 accuracy: 0.9771 val_loss: 0.2561 val_accuracy: 0.9418
Epoch: 58 loss: 0.1097 accuracy: 0.9775 val_loss: 0.2674 val_accuracy: 0.9325
Epoch: 59 loss: 0.1077 accuracy: 0.9784 val_loss: 0.2514 val_accuracy: 0.9400

Epoch 00059: ReduceLROnPlateau reducing learning rate to 5.119999987073243e-05.
Epoch: 60 loss: 0.1023 accuracy: 0.9802 val_loss: 0.2636 val_accuracy: 0.9380
Epoch: 61 loss: 0.1007 accuracy: 0.9814 val_loss: 0.2440 val_accuracy: 0.9438
Epoch: 62 loss: 0.0991 accuracy: 0.9817 val_loss: 0.2536 val_accuracy: 0.9417
Epoch: 63 loss: 0.0971 accuracy: 0.9823 val_loss: 0.2529 val_accuracy: 0.9423
Epoch: 64 loss: 0.0982 accuracy: 0.9818 val_loss: 0.2542 val_accuracy: 0.9409
Epoch: 65 loss: 0.0944 accuracy: 0.9828 val_loss: 0.2535 val_accuracy: 0.9414
Epoch: 66 loss: 0.0965 accuracy: 0.9819 val_loss: 0.2690 val_accuracy: 0.9406

Epoch 00066: ReduceLROnPlateau reducing learning rate to 4.0960000478662555e-05.
Epoch: 67 loss: 0.0909 accuracy: 0.9841 val_loss: 0.2613 val_accuracy: 0.9424
Epoch: 68 loss: 0.0891 accuracy: 0.9848 val_loss: 0.2528 val_accuracy: 0.9423
Epoch: 69 loss: 0.0879 accuracy: 0.9849 val_loss: 0.2618 val_accuracy: 0.9414
Epoch: 70 loss: 0.0876 accuracy: 0.9856 val_loss: 0.2495 val_accuracy: 0.9445
Epoch: 71 loss: 0.0872 accuracy: 0.9853 val_loss: 0.2543 val_accuracy: 0.9447

Epoch 00071: ReduceLROnPlateau reducing learning rate to 3.2767999800853435e-05.
End of augmented training
Finish
Job ended!
