Sun 05 May 2024 08:05:08 PM EDT
Python 3.9.7
nvcc: NVIDIA (R) Cuda compiler driver
Copyright (c) 2005-2019 NVIDIA Corporation
Built on Sun_Jul_28_19:07:16_PDT_2019
Cuda compilation tools, release 10.1, V10.1.243
My SLURM_ARRAY_TASK_ID: 
DB: ['ISIC2016', 'PAD_UFES_20', 'MEDNODE']
IMG_SIZE: [384, 384]
CLASSIFIER: ResNet101
JOB_INDEX: None
Start training augmented images
Combining...
Combining 1th db out of 3 dbs
Combining 2th db out of 3 dbs
Combining 3th db out of 3 dbs
Stacking data
Combining complete
Model: "sequential"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
resnet101 (Functional)       (None, 2048)              42658176  
_________________________________________________________________
dense (Dense)                (None, 512)               1049088   
_________________________________________________________________
dropout (Dropout)            (None, 512)               0         
_________________________________________________________________
batch_normalization (BatchNo (None, 512)               2048      
_________________________________________________________________
dense_1 (Dense)              (None, 256)               131328    
_________________________________________________________________
batch_normalization_1 (Batch (None, 256)               1024      
_________________________________________________________________
dense_2 (Dense)              (None, 2)                 514       
=================================================================
Total params: 43,842,178
Trainable params: 1,182,466
Non-trainable params: 42,659,712
_________________________________________________________________
Fitting ISIC2016+PAD_UFES_20+MEDNODE_aug_ResNet101_384h_384w_None model...
model_name: ISIC2016+PAD_UFES_20+MEDNODE_aug_ResNet101_384h_384w_None
Epoch: 1 loss: 1.4399 accuracy: 0.5494 val_loss: 0.8148 val_accuracy: 0.9095
Epoch: 2 loss: 1.2363 accuracy: 0.5776 val_loss: 0.8201 val_accuracy: 0.9095
Epoch: 3 loss: 1.0572 accuracy: 0.6036 val_loss: 0.9961 val_accuracy: 0.6350
Epoch: 4 loss: 0.9679 accuracy: 0.6358 val_loss: 0.8939 val_accuracy: 0.8724
Epoch: 5 loss: 0.9089 accuracy: 0.6406 val_loss: 0.6714 val_accuracy: 0.9095
Epoch: 6 loss: 0.8619 accuracy: 0.6605 val_loss: 0.5602 val_accuracy: 0.9095
Epoch: 7 loss: 0.8447 accuracy: 0.6626 val_loss: 0.5071 val_accuracy: 0.9095
Epoch: 8 loss: 0.8334 accuracy: 0.6741 val_loss: 0.4976 val_accuracy: 0.9095
Epoch: 9 loss: 0.8154 accuracy: 0.6787 val_loss: 0.5386 val_accuracy: 0.9095
Epoch: 10 loss: 0.8001 accuracy: 0.6870 val_loss: 0.5717 val_accuracy: 0.9095
Epoch: 11 loss: 0.7948 accuracy: 0.6857 val_loss: 0.5048 val_accuracy: 0.9095
Epoch: 12 loss: 0.7894 accuracy: 0.6905 val_loss: 0.5123 val_accuracy: 0.9095
Epoch: 13 loss: 0.7685 accuracy: 0.7089 val_loss: 0.5820 val_accuracy: 0.9095

Epoch 00013: ReduceLROnPlateau reducing learning rate to 7.999999797903001e-05.
Epoch: 14 loss: 0.7578 accuracy: 0.7122 val_loss: 0.4804 val_accuracy: 0.9095
Epoch: 15 loss: 0.7493 accuracy: 0.7157 val_loss: 0.4619 val_accuracy: 0.9095
Epoch: 16 loss: 0.7469 accuracy: 0.7200 val_loss: 0.4632 val_accuracy: 0.9095
Epoch: 17 loss: 0.7340 accuracy: 0.7331 val_loss: 0.4657 val_accuracy: 0.9095
Epoch: 18 loss: 0.7161 accuracy: 0.7369 val_loss: 0.4769 val_accuracy: 0.9095
Epoch: 19 loss: 0.6880 accuracy: 0.7545 val_loss: 0.4557 val_accuracy: 0.9095
Epoch: 20 loss: 0.7195 accuracy: 0.7278 val_loss: 0.4509 val_accuracy: 0.9095
Epoch: 21 loss: 0.6994 accuracy: 0.7349 val_loss: 0.4486 val_accuracy: 0.9095
Epoch: 22 loss: 0.7097 accuracy: 0.7445 val_loss: 0.4496 val_accuracy: 0.9095
Epoch: 23 loss: 0.7126 accuracy: 0.7432 val_loss: 0.4581 val_accuracy: 0.9095
Epoch: 24 loss: 0.6996 accuracy: 0.7412 val_loss: 0.4445 val_accuracy: 0.9095
Epoch: 25 loss: 0.6772 accuracy: 0.7497 val_loss: 0.4515 val_accuracy: 0.9095
Epoch: 26 loss: 0.6641 accuracy: 0.7651 val_loss: 0.4844 val_accuracy: 0.9080
Epoch: 27 loss: 0.6816 accuracy: 0.7508 val_loss: 0.4811 val_accuracy: 0.9095
Epoch: 28 loss: 0.6677 accuracy: 0.7588 val_loss: 0.4672 val_accuracy: 0.9095
Epoch: 29 loss: 0.6685 accuracy: 0.7629 val_loss: 0.5870 val_accuracy: 0.9095

Epoch 00029: ReduceLROnPlateau reducing learning rate to 6.399999838322402e-05.
Epoch: 30 loss: 0.6568 accuracy: 0.7692 val_loss: 0.4304 val_accuracy: 0.9095
Epoch: 31 loss: 0.6576 accuracy: 0.7686 val_loss: 0.4351 val_accuracy: 0.9095
Epoch: 32 loss: 0.6492 accuracy: 0.7709 val_loss: 0.4490 val_accuracy: 0.9095
Epoch: 33 loss: 0.6618 accuracy: 0.7621 val_loss: 0.4316 val_accuracy: 0.9095
Epoch: 34 loss: 0.6703 accuracy: 0.7472 val_loss: 0.4251 val_accuracy: 0.9065
Epoch: 35 loss: 0.6528 accuracy: 0.7601 val_loss: 0.4234 val_accuracy: 0.9095
Epoch: 36 loss: 0.6431 accuracy: 0.7697 val_loss: 0.4366 val_accuracy: 0.9095
Epoch: 37 loss: 0.6515 accuracy: 0.7553 val_loss: 0.8384 val_accuracy: 0.5490
Epoch: 38 loss: 0.6337 accuracy: 0.7651 val_loss: 0.4270 val_accuracy: 0.9050
Epoch: 39 loss: 0.6371 accuracy: 0.7596 val_loss: 0.4282 val_accuracy: 0.9095
Epoch: 40 loss: 0.6292 accuracy: 0.7704 val_loss: 0.4892 val_accuracy: 0.8932

Epoch 00040: ReduceLROnPlateau reducing learning rate to 5.119999987073243e-05.
Epoch: 41 loss: 0.6366 accuracy: 0.7629 val_loss: 0.4399 val_accuracy: 0.9095
Epoch: 42 loss: 0.6132 accuracy: 0.7755 val_loss: 0.4626 val_accuracy: 0.9006
Epoch: 43 loss: 0.6298 accuracy: 0.7674 val_loss: 0.4317 val_accuracy: 0.9050
Epoch: 44 loss: 0.6269 accuracy: 0.7714 val_loss: 0.4575 val_accuracy: 0.9050
Epoch: 45 loss: 0.6163 accuracy: 0.7734 val_loss: 0.4136 val_accuracy: 0.9036
Epoch: 46 loss: 0.6092 accuracy: 0.7760 val_loss: 0.4124 val_accuracy: 0.9065
Epoch: 47 loss: 0.6068 accuracy: 0.7800 val_loss: 0.4101 val_accuracy: 0.9065
Epoch: 48 loss: 0.6151 accuracy: 0.7712 val_loss: 0.4817 val_accuracy: 0.8828
Epoch: 49 loss: 0.6150 accuracy: 0.7724 val_loss: 0.4577 val_accuracy: 0.8932
Epoch: 50 loss: 0.6031 accuracy: 0.7818 val_loss: 0.4256 val_accuracy: 0.9095
Epoch: 51 loss: 0.6113 accuracy: 0.7702 val_loss: 0.4632 val_accuracy: 0.9095
Epoch: 52 loss: 0.5986 accuracy: 0.7812 val_loss: 0.4144 val_accuracy: 0.9095

Epoch 00052: ReduceLROnPlateau reducing learning rate to 4.0960000478662555e-05.
Epoch: 53 loss: 0.6008 accuracy: 0.7782 val_loss: 0.4354 val_accuracy: 0.9065
Epoch: 54 loss: 0.5936 accuracy: 0.7767 val_loss: 0.4664 val_accuracy: 0.9095
Epoch: 55 loss: 0.5817 accuracy: 0.7853 val_loss: 0.4211 val_accuracy: 0.9080
Epoch: 56 loss: 0.6101 accuracy: 0.7772 val_loss: 0.4070 val_accuracy: 0.9095
Epoch: 57 loss: 0.6034 accuracy: 0.7692 val_loss: 0.4549 val_accuracy: 0.9050
Epoch: 58 loss: 0.5815 accuracy: 0.7820 val_loss: 0.4190 val_accuracy: 0.9050
Epoch: 59 loss: 0.5855 accuracy: 0.7792 val_loss: 1.3050 val_accuracy: 0.1261
Epoch: 60 loss: 0.5891 accuracy: 0.7737 val_loss: 0.4496 val_accuracy: 0.9065
Epoch: 61 loss: 0.5903 accuracy: 0.7737 val_loss: 0.4547 val_accuracy: 0.9095

Epoch 00061: ReduceLROnPlateau reducing learning rate to 3.2767999800853435e-05.
Epoch: 62 loss: 0.5814 accuracy: 0.7749 val_loss: 0.5163 val_accuracy: 0.9095
Epoch: 63 loss: 0.5732 accuracy: 0.7865 val_loss: 0.4868 val_accuracy: 0.9006
Epoch: 64 loss: 0.5717 accuracy: 0.7835 val_loss: 0.4742 val_accuracy: 0.9006
Epoch: 65 loss: 0.5583 accuracy: 0.7926 val_loss: 0.4623 val_accuracy: 0.9050
Epoch: 66 loss: 0.5684 accuracy: 0.7858 val_loss: 0.5102 val_accuracy: 0.9095

Epoch 00066: ReduceLROnPlateau reducing learning rate to 2.6214399258606137e-05.
End of augmented training
Finish
Job ended!
