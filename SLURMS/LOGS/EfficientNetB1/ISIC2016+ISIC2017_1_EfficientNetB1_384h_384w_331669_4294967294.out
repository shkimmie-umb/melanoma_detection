Thu 02 May 2024 10:51:44 PM EDT
Python 3.9.7
nvcc: NVIDIA (R) Cuda compiler driver
Copyright (c) 2005-2019 NVIDIA Corporation
Built on Sun_Jul_28_19:07:16_PDT_2019
Cuda compilation tools, release 10.1, V10.1.243
My SLURM_ARRAY_TASK_ID: 
DB: ['ISIC2016', 'ISIC2017']
IMG_SIZE: [384, 384]
CLASSIFIER: EfficientNetB1
JOB_INDEX: None
Start training augmented images
Combining...
Combining 1th db out of 2 dbs
Combining 2th db out of 2 dbs
Stacking data
Combining complete
Model: "sequential"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
efficientnetb1 (Functional)  (None, 1280)              6575239   
_________________________________________________________________
dense (Dense)                (None, 512)               655872    
_________________________________________________________________
dropout (Dropout)            (None, 512)               0         
_________________________________________________________________
batch_normalization (BatchNo (None, 512)               2048      
_________________________________________________________________
dense_1 (Dense)              (None, 256)               131328    
_________________________________________________________________
batch_normalization_1 (Batch (None, 256)               1024      
_________________________________________________________________
dense_2 (Dense)              (None, 2)                 514       
=================================================================
Total params: 7,366,025
Trainable params: 789,250
Non-trainable params: 6,576,775
_________________________________________________________________
Fitting ISIC2016+ISIC2017_aug_EfficientNetB1_384h_384w_None model...
model_name: ISIC2016+ISIC2017_aug_EfficientNetB1_384h_384w_None
Epoch: 1 loss: 1.4521 accuracy: 0.5072 val_loss: 1.1223 val_accuracy: 0.8121
Epoch: 2 loss: 1.3288 accuracy: 0.5178 val_loss: 1.0163 val_accuracy: 0.8121
Epoch: 3 loss: 1.2365 accuracy: 0.5385 val_loss: 0.9653 val_accuracy: 0.8121
Epoch: 4 loss: 1.2005 accuracy: 0.5587 val_loss: 0.9460 val_accuracy: 0.8121
Epoch: 5 loss: 1.1875 accuracy: 0.5594 val_loss: 0.9355 val_accuracy: 0.8121
Epoch: 6 loss: 1.1633 accuracy: 0.5702 val_loss: 0.9287 val_accuracy: 0.8121
Epoch: 7 loss: 1.1476 accuracy: 0.5745 val_loss: 0.9202 val_accuracy: 0.8121
Epoch: 8 loss: 1.1278 accuracy: 0.5870 val_loss: 0.9254 val_accuracy: 0.8121
Epoch: 9 loss: 1.1136 accuracy: 0.5974 val_loss: 0.9337 val_accuracy: 0.8121
Epoch: 10 loss: 1.1191 accuracy: 0.5856 val_loss: 0.9079 val_accuracy: 0.8121
Epoch: 11 loss: 1.1012 accuracy: 0.6058 val_loss: 0.9734 val_accuracy: 0.8121
Epoch: 12 loss: 1.1074 accuracy: 0.5870 val_loss: 0.9023 val_accuracy: 0.8121
Epoch: 13 loss: 1.0872 accuracy: 0.6036 val_loss: 0.9191 val_accuracy: 0.8121
Epoch: 14 loss: 1.0773 accuracy: 0.6120 val_loss: 0.9330 val_accuracy: 0.8121
Epoch: 15 loss: 1.0836 accuracy: 0.5952 val_loss: 0.8955 val_accuracy: 0.8121
Epoch: 16 loss: 1.0725 accuracy: 0.6026 val_loss: 0.9220 val_accuracy: 0.8121
Epoch: 17 loss: 1.0581 accuracy: 0.6161 val_loss: 0.9267 val_accuracy: 0.8121
Epoch: 18 loss: 1.0585 accuracy: 0.6103 val_loss: 0.8848 val_accuracy: 0.8121
Epoch: 19 loss: 1.0458 accuracy: 0.6274 val_loss: 0.8778 val_accuracy: 0.8121
Epoch: 20 loss: 1.0533 accuracy: 0.6046 val_loss: 0.8946 val_accuracy: 0.8121
Epoch: 21 loss: 1.0377 accuracy: 0.6255 val_loss: 0.8910 val_accuracy: 0.8121
Epoch: 22 loss: 1.0364 accuracy: 0.6192 val_loss: 0.8491 val_accuracy: 0.8121
Epoch: 23 loss: 1.0387 accuracy: 0.6070 val_loss: 0.9674 val_accuracy: 0.8121
Epoch: 24 loss: 1.0374 accuracy: 0.5966 val_loss: 0.9298 val_accuracy: 0.8121
Epoch: 25 loss: 1.0329 accuracy: 0.6034 val_loss: 0.8697 val_accuracy: 0.8121
Epoch: 26 loss: 1.0173 accuracy: 0.6257 val_loss: 0.8453 val_accuracy: 0.8121
Epoch: 27 loss: 1.0101 accuracy: 0.6255 val_loss: 0.8554 val_accuracy: 0.8121
Epoch: 28 loss: 1.0130 accuracy: 0.6264 val_loss: 0.8912 val_accuracy: 0.8121
Epoch: 29 loss: 1.0086 accuracy: 0.6149 val_loss: 0.8841 val_accuracy: 0.8121
Epoch: 30 loss: 1.0029 accuracy: 0.6267 val_loss: 0.8677 val_accuracy: 0.8121
Epoch: 31 loss: 1.0039 accuracy: 0.6212 val_loss: 0.8954 val_accuracy: 0.8121

Epoch 00031: ReduceLROnPlateau reducing learning rate to 7.999999797903001e-05.
Epoch: 32 loss: 0.9959 accuracy: 0.6252 val_loss: 0.9047 val_accuracy: 0.8121
Epoch: 33 loss: 1.0020 accuracy: 0.6108 val_loss: 0.8854 val_accuracy: 0.8121
Epoch: 34 loss: 0.9840 accuracy: 0.6325 val_loss: 0.8375 val_accuracy: 0.8121
Epoch: 35 loss: 0.9854 accuracy: 0.6255 val_loss: 0.8337 val_accuracy: 0.8121
Epoch: 36 loss: 0.9827 accuracy: 0.6250 val_loss: 0.8277 val_accuracy: 0.8121
Epoch: 37 loss: 0.9773 accuracy: 0.6276 val_loss: 0.8591 val_accuracy: 0.8121
Epoch: 38 loss: 0.9758 accuracy: 0.6238 val_loss: 0.8242 val_accuracy: 0.8121
Epoch: 39 loss: 0.9760 accuracy: 0.6204 val_loss: 0.8503 val_accuracy: 0.8121
Epoch: 40 loss: 0.9650 accuracy: 0.6337 val_loss: 0.8553 val_accuracy: 0.8121
Epoch: 41 loss: 0.9673 accuracy: 0.6255 val_loss: 0.8616 val_accuracy: 0.8121
Epoch: 42 loss: 0.9636 accuracy: 0.6248 val_loss: 0.8306 val_accuracy: 0.8121
Epoch: 43 loss: 0.9537 accuracy: 0.6339 val_loss: 0.8120 val_accuracy: 0.8121
Epoch: 44 loss: 0.9539 accuracy: 0.6279 val_loss: 0.8711 val_accuracy: 0.8121
Epoch: 45 loss: 0.9551 accuracy: 0.6166 val_loss: 0.8106 val_accuracy: 0.8121
Epoch: 46 loss: 0.9581 accuracy: 0.6147 val_loss: 0.8396 val_accuracy: 0.8121
Epoch: 47 loss: 0.9374 accuracy: 0.6356 val_loss: 0.7880 val_accuracy: 0.8121
Epoch: 48 loss: 0.9408 accuracy: 0.6337 val_loss: 0.8020 val_accuracy: 0.8121
Epoch: 49 loss: 0.9397 accuracy: 0.6250 val_loss: 0.8472 val_accuracy: 0.8121
Epoch: 50 loss: 0.9433 accuracy: 0.6144 val_loss: 0.8202 val_accuracy: 0.8121
Epoch: 51 loss: 0.9316 accuracy: 0.6255 val_loss: 0.7727 val_accuracy: 0.8121
Epoch: 52 loss: 0.9341 accuracy: 0.6166 val_loss: 0.8253 val_accuracy: 0.8121
Epoch: 53 loss: 0.9222 accuracy: 0.6373 val_loss: 0.8311 val_accuracy: 0.8121
Epoch: 54 loss: 0.9144 accuracy: 0.6457 val_loss: 0.7952 val_accuracy: 0.8121
Epoch: 55 loss: 0.9175 accuracy: 0.6293 val_loss: 0.8056 val_accuracy: 0.8121
Epoch: 56 loss: 0.9183 accuracy: 0.6274 val_loss: 0.8200 val_accuracy: 0.8121

Epoch 00056: ReduceLROnPlateau reducing learning rate to 6.399999838322402e-05.
Epoch: 57 loss: 0.9076 accuracy: 0.6377 val_loss: 0.7626 val_accuracy: 0.8121
Epoch: 58 loss: 0.9109 accuracy: 0.6327 val_loss: 0.8019 val_accuracy: 0.8121
Epoch: 59 loss: 0.9117 accuracy: 0.6192 val_loss: 0.8066 val_accuracy: 0.8121
Epoch: 60 loss: 0.9060 accuracy: 0.6300 val_loss: 0.7600 val_accuracy: 0.8121
Epoch: 61 loss: 0.8994 accuracy: 0.6315 val_loss: 0.7674 val_accuracy: 0.8121
Epoch: 62 loss: 0.8966 accuracy: 0.6332 val_loss: 0.7894 val_accuracy: 0.8121
Epoch: 63 loss: 0.8909 accuracy: 0.6370 val_loss: 0.7768 val_accuracy: 0.8121
Epoch: 64 loss: 0.8948 accuracy: 0.6313 val_loss: 0.7516 val_accuracy: 0.8121
Epoch: 65 loss: 0.8929 accuracy: 0.6245 val_loss: 0.7958 val_accuracy: 0.8121
Epoch: 66 loss: 0.8815 accuracy: 0.6416 val_loss: 0.7949 val_accuracy: 0.8121
Epoch: 67 loss: 0.8806 accuracy: 0.6387 val_loss: 0.7710 val_accuracy: 0.8121
Epoch: 68 loss: 0.8844 accuracy: 0.6257 val_loss: 0.7629 val_accuracy: 0.8121
Epoch: 69 loss: 0.8817 accuracy: 0.6264 val_loss: 0.7856 val_accuracy: 0.8121

Epoch 00069: ReduceLROnPlateau reducing learning rate to 5.119999987073243e-05.
Epoch: 70 loss: 0.8762 accuracy: 0.6281 val_loss: 0.7558 val_accuracy: 0.8121
Epoch: 71 loss: 0.8711 accuracy: 0.6327 val_loss: 0.7567 val_accuracy: 0.8121
Epoch: 72 loss: 0.8726 accuracy: 0.6269 val_loss: 0.7880 val_accuracy: 0.8121
Epoch: 73 loss: 0.8739 accuracy: 0.6252 val_loss: 0.7400 val_accuracy: 0.8121
Epoch: 74 loss: 0.8671 accuracy: 0.6320 val_loss: 0.7940 val_accuracy: 0.8121
Epoch: 75 loss: 0.8655 accuracy: 0.6337 val_loss: 0.7663 val_accuracy: 0.8121
Epoch: 76 loss: 0.8564 accuracy: 0.6462 val_loss: 0.7581 val_accuracy: 0.8121
Epoch: 77 loss: 0.8615 accuracy: 0.6305 val_loss: 0.7448 val_accuracy: 0.8121
Epoch: 78 loss: 0.8514 accuracy: 0.6425 val_loss: 0.7524 val_accuracy: 0.8121

Epoch 00078: ReduceLROnPlateau reducing learning rate to 4.0960000478662555e-05.
Epoch: 79 loss: 0.8573 accuracy: 0.6296 val_loss: 0.7538 val_accuracy: 0.8121
Epoch: 80 loss: 0.8653 accuracy: 0.6166 val_loss: 0.7475 val_accuracy: 0.8121
Epoch: 81 loss: 0.8526 accuracy: 0.6308 val_loss: 0.7330 val_accuracy: 0.8121
Epoch: 82 loss: 0.8473 accuracy: 0.6358 val_loss: 0.7211 val_accuracy: 0.8121
Epoch: 83 loss: 0.8557 accuracy: 0.6257 val_loss: 0.7256 val_accuracy: 0.8121
Epoch: 84 loss: 0.8403 accuracy: 0.6421 val_loss: 0.7250 val_accuracy: 0.8121
Epoch: 85 loss: 0.8455 accuracy: 0.6332 val_loss: 0.7307 val_accuracy: 0.8121
Epoch: 86 loss: 0.8466 accuracy: 0.6262 val_loss: 0.6951 val_accuracy: 0.8121
Epoch: 87 loss: 0.8482 accuracy: 0.6204 val_loss: 0.7359 val_accuracy: 0.8121
Epoch: 88 loss: 0.8407 accuracy: 0.6375 val_loss: 0.7222 val_accuracy: 0.8121
Epoch: 89 loss: 0.8323 accuracy: 0.6450 val_loss: 0.7112 val_accuracy: 0.8121
Epoch: 90 loss: 0.8460 accuracy: 0.6118 val_loss: 0.7301 val_accuracy: 0.8121
Epoch: 91 loss: 0.8420 accuracy: 0.6154 val_loss: 0.6967 val_accuracy: 0.8121

Epoch 00091: ReduceLROnPlateau reducing learning rate to 3.2767999800853435e-05.
Epoch: 92 loss: 0.8326 accuracy: 0.6308 val_loss: 0.7254 val_accuracy: 0.8121
Epoch: 93 loss: 0.8263 accuracy: 0.6389 val_loss: 0.7128 val_accuracy: 0.8121
Epoch: 94 loss: 0.8291 accuracy: 0.6329 val_loss: 0.7369 val_accuracy: 0.8121
Epoch: 95 loss: 0.8259 accuracy: 0.6416 val_loss: 0.7162 val_accuracy: 0.8121
Epoch: 96 loss: 0.8286 accuracy: 0.6286 val_loss: 0.7212 val_accuracy: 0.8121

Epoch 00096: ReduceLROnPlateau reducing learning rate to 2.6214399258606137e-05.
End of augmented training
Finish
Job ended!
