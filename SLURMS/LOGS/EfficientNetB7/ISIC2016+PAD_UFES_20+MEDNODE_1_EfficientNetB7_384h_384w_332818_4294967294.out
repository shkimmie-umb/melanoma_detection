Wed 08 May 2024 06:04:53 PM EDT
Python 3.9.7
nvcc: NVIDIA (R) Cuda compiler driver
Copyright (c) 2005-2019 NVIDIA Corporation
Built on Sun_Jul_28_19:07:16_PDT_2019
Cuda compilation tools, release 10.1, V10.1.243
My SLURM_ARRAY_TASK_ID: 
DB: ['ISIC2016', 'PAD_UFES_20', 'MEDNODE']
IMG_SIZE: [384, 384]
CLASSIFIER: EfficientNetB7
JOB_INDEX: None
Start training augmented images
Combining...
Combining 1th db out of 3 dbs
Combining 2th db out of 3 dbs
Combining 3th db out of 3 dbs
Stacking data
Combining complete
Model: "sequential"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
efficientnetb7 (Functional)  (None, 2560)              64097687  
_________________________________________________________________
dense (Dense)                (None, 512)               1311232   
_________________________________________________________________
dropout (Dropout)            (None, 512)               0         
_________________________________________________________________
batch_normalization (BatchNo (None, 512)               2048      
_________________________________________________________________
dense_1 (Dense)              (None, 256)               131328    
_________________________________________________________________
batch_normalization_1 (Batch (None, 256)               1024      
_________________________________________________________________
dense_2 (Dense)              (None, 2)                 514       
=================================================================
Total params: 65,543,833
Trainable params: 1,444,610
Non-trainable params: 64,099,223
_________________________________________________________________
Fitting ISIC2016+PAD_UFES_20+MEDNODE_aug_EfficientNetB7_384h_384w_None model...
model_name: ISIC2016+PAD_UFES_20+MEDNODE_aug_EfficientNetB7_384h_384w_None
Epoch: 1 loss: 1.4986 accuracy: 0.5146 val_loss: 1.1100 val_accuracy: 0.9095
Epoch: 2 loss: 1.3302 accuracy: 0.5461 val_loss: 1.0031 val_accuracy: 0.9095
Epoch: 3 loss: 1.2336 accuracy: 0.5953 val_loss: 0.9763 val_accuracy: 0.9095
Epoch: 4 loss: 1.1873 accuracy: 0.5983 val_loss: 0.8753 val_accuracy: 0.9095
Epoch: 5 loss: 1.1404 accuracy: 0.6394 val_loss: 0.8634 val_accuracy: 0.9095
Epoch: 6 loss: 1.1009 accuracy: 0.6749 val_loss: 0.8668 val_accuracy: 0.9095
Epoch: 7 loss: 1.0798 accuracy: 0.6867 val_loss: 0.8753 val_accuracy: 0.9095
Epoch: 8 loss: 1.0652 accuracy: 0.7006 val_loss: 0.7961 val_accuracy: 0.9095
Epoch: 9 loss: 1.0402 accuracy: 0.7130 val_loss: 0.8033 val_accuracy: 0.9095
Epoch: 10 loss: 1.0235 accuracy: 0.7314 val_loss: 0.8074 val_accuracy: 0.9095
Epoch: 11 loss: 1.0411 accuracy: 0.7160 val_loss: 0.8676 val_accuracy: 0.9095
Epoch: 12 loss: 1.0222 accuracy: 0.7271 val_loss: 0.7200 val_accuracy: 0.9095
Epoch: 13 loss: 1.0138 accuracy: 0.7308 val_loss: 0.7670 val_accuracy: 0.9095
Epoch: 14 loss: 0.9934 accuracy: 0.7374 val_loss: 0.8061 val_accuracy: 0.9095
Epoch: 15 loss: 0.9991 accuracy: 0.7331 val_loss: 0.7765 val_accuracy: 0.9095
Epoch: 16 loss: 0.9799 accuracy: 0.7419 val_loss: 0.7945 val_accuracy: 0.9095
Epoch: 17 loss: 0.9644 accuracy: 0.7530 val_loss: 0.7458 val_accuracy: 0.9095

Epoch 00017: ReduceLROnPlateau reducing learning rate to 7.999999797903001e-05.
Epoch: 18 loss: 0.9998 accuracy: 0.7208 val_loss: 0.8696 val_accuracy: 0.9095
Epoch: 19 loss: 0.9772 accuracy: 0.7329 val_loss: 0.7940 val_accuracy: 0.9095
Epoch: 20 loss: 0.9532 accuracy: 0.7472 val_loss: 0.7398 val_accuracy: 0.9095
Epoch: 21 loss: 0.9483 accuracy: 0.7495 val_loss: 0.7067 val_accuracy: 0.9095
Epoch: 22 loss: 0.9337 accuracy: 0.7563 val_loss: 0.7263 val_accuracy: 0.9095
Epoch: 23 loss: 0.9648 accuracy: 0.7288 val_loss: 0.8362 val_accuracy: 0.9095
Epoch: 24 loss: 0.9392 accuracy: 0.7480 val_loss: 0.6865 val_accuracy: 0.9095
Epoch: 25 loss: 0.9503 accuracy: 0.7334 val_loss: 0.6965 val_accuracy: 0.9095
Epoch: 26 loss: 0.9318 accuracy: 0.7460 val_loss: 0.6941 val_accuracy: 0.9095
Epoch: 27 loss: 0.9385 accuracy: 0.7351 val_loss: 0.7119 val_accuracy: 0.9095
Epoch: 28 loss: 0.9398 accuracy: 0.7326 val_loss: 0.6595 val_accuracy: 0.9095
Epoch: 29 loss: 0.9189 accuracy: 0.7470 val_loss: 0.6569 val_accuracy: 0.9095
Epoch: 30 loss: 0.9291 accuracy: 0.7366 val_loss: 0.6751 val_accuracy: 0.9095
Epoch: 31 loss: 0.9144 accuracy: 0.7467 val_loss: 0.7478 val_accuracy: 0.9095
Epoch: 32 loss: 0.9133 accuracy: 0.7429 val_loss: 0.6742 val_accuracy: 0.9095
Epoch: 33 loss: 0.9055 accuracy: 0.7432 val_loss: 0.7395 val_accuracy: 0.9095
Epoch: 34 loss: 0.9138 accuracy: 0.7349 val_loss: 0.7035 val_accuracy: 0.9095

Epoch 00034: ReduceLROnPlateau reducing learning rate to 6.399999838322402e-05.
Epoch: 35 loss: 0.8974 accuracy: 0.7442 val_loss: 0.6484 val_accuracy: 0.9095
Epoch: 36 loss: 0.8897 accuracy: 0.7508 val_loss: 0.6890 val_accuracy: 0.9095
Epoch: 37 loss: 0.8964 accuracy: 0.7394 val_loss: 0.6722 val_accuracy: 0.9095
Epoch: 38 loss: 0.8916 accuracy: 0.7407 val_loss: 0.6758 val_accuracy: 0.9095
Epoch: 39 loss: 0.8726 accuracy: 0.7505 val_loss: 0.6642 val_accuracy: 0.9095
Epoch: 40 loss: 0.8826 accuracy: 0.7419 val_loss: 0.6536 val_accuracy: 0.9095

Epoch 00040: ReduceLROnPlateau reducing learning rate to 5.119999987073243e-05.
Epoch: 41 loss: 0.8790 accuracy: 0.7389 val_loss: 0.6240 val_accuracy: 0.9095
Epoch: 42 loss: 0.8713 accuracy: 0.7495 val_loss: 0.7066 val_accuracy: 0.9095
Epoch: 43 loss: 0.8805 accuracy: 0.7382 val_loss: 0.7294 val_accuracy: 0.9095
Epoch: 44 loss: 0.8457 accuracy: 0.7636 val_loss: 0.6510 val_accuracy: 0.9095
Epoch: 45 loss: 0.8594 accuracy: 0.7495 val_loss: 0.6969 val_accuracy: 0.9095
Epoch: 46 loss: 0.8485 accuracy: 0.7566 val_loss: 0.6740 val_accuracy: 0.9095

Epoch 00046: ReduceLROnPlateau reducing learning rate to 4.0960000478662555e-05.
Epoch: 47 loss: 0.8616 accuracy: 0.7445 val_loss: 0.6599 val_accuracy: 0.9095
Epoch: 48 loss: 0.8544 accuracy: 0.7467 val_loss: 0.6244 val_accuracy: 0.9095
Epoch: 49 loss: 0.8471 accuracy: 0.7515 val_loss: 0.7383 val_accuracy: 0.9095
Epoch: 50 loss: 0.8473 accuracy: 0.7490 val_loss: 0.6216 val_accuracy: 0.9095
Epoch: 51 loss: 0.8431 accuracy: 0.7472 val_loss: 0.6317 val_accuracy: 0.9095
Epoch: 52 loss: 0.8490 accuracy: 0.7427 val_loss: 0.6461 val_accuracy: 0.9095
Epoch: 53 loss: 0.8472 accuracy: 0.7412 val_loss: 0.6658 val_accuracy: 0.9095
Epoch: 54 loss: 0.8478 accuracy: 0.7407 val_loss: 0.6585 val_accuracy: 0.9095
Epoch: 55 loss: 0.8325 accuracy: 0.7518 val_loss: 0.6113 val_accuracy: 0.9095
Epoch: 56 loss: 0.8351 accuracy: 0.7477 val_loss: 0.6673 val_accuracy: 0.9095
Epoch: 57 loss: 0.8420 accuracy: 0.7387 val_loss: 0.6521 val_accuracy: 0.9095
Epoch: 58 loss: 0.8360 accuracy: 0.7460 val_loss: 0.6157 val_accuracy: 0.9095
Epoch: 59 loss: 0.8246 accuracy: 0.7487 val_loss: 0.6004 val_accuracy: 0.9095
Epoch: 60 loss: 0.8126 accuracy: 0.7581 val_loss: 0.6236 val_accuracy: 0.9095
Epoch: 61 loss: 0.8241 accuracy: 0.7455 val_loss: 0.5904 val_accuracy: 0.9095
Epoch: 62 loss: 0.8156 accuracy: 0.7505 val_loss: 0.5951 val_accuracy: 0.9095
Epoch: 63 loss: 0.8232 accuracy: 0.7417 val_loss: 0.6042 val_accuracy: 0.9095
Epoch: 64 loss: 0.8289 accuracy: 0.7354 val_loss: 0.6065 val_accuracy: 0.9095
Epoch: 65 loss: 0.8093 accuracy: 0.7475 val_loss: 0.6264 val_accuracy: 0.9095
Epoch: 66 loss: 0.8200 accuracy: 0.7409 val_loss: 0.6164 val_accuracy: 0.9095

Epoch 00066: ReduceLROnPlateau reducing learning rate to 3.2767999800853435e-05.
Epoch: 67 loss: 0.8241 accuracy: 0.7339 val_loss: 0.6129 val_accuracy: 0.9095
Epoch: 68 loss: 0.8064 accuracy: 0.7455 val_loss: 0.6024 val_accuracy: 0.9095
Epoch: 69 loss: 0.8128 accuracy: 0.7374 val_loss: 0.5887 val_accuracy: 0.9095
Epoch: 70 loss: 0.8108 accuracy: 0.7382 val_loss: 0.5828 val_accuracy: 0.9095
Epoch: 71 loss: 0.8099 accuracy: 0.7374 val_loss: 0.6024 val_accuracy: 0.9095
Epoch: 72 loss: 0.8016 accuracy: 0.7437 val_loss: 0.6261 val_accuracy: 0.9095
Epoch: 73 loss: 0.7986 accuracy: 0.7404 val_loss: 0.6401 val_accuracy: 0.9095
Epoch: 74 loss: 0.8027 accuracy: 0.7374 val_loss: 0.6373 val_accuracy: 0.9095
Epoch: 75 loss: 0.7975 accuracy: 0.7414 val_loss: 0.5807 val_accuracy: 0.9095
Epoch: 76 loss: 0.8024 accuracy: 0.7351 val_loss: 0.6388 val_accuracy: 0.9095
Epoch: 77 loss: 0.7871 accuracy: 0.7475 val_loss: 0.6374 val_accuracy: 0.9095
Epoch: 78 loss: 0.7875 accuracy: 0.7429 val_loss: 0.5830 val_accuracy: 0.9095
Epoch: 79 loss: 0.7934 accuracy: 0.7374 val_loss: 0.5994 val_accuracy: 0.9095
Epoch: 80 loss: 0.7729 accuracy: 0.7545 val_loss: 0.5915 val_accuracy: 0.9095

Epoch 00080: ReduceLROnPlateau reducing learning rate to 2.6214399258606137e-05.
Epoch: 81 loss: 0.7826 accuracy: 0.7414 val_loss: 0.5881 val_accuracy: 0.9095
Epoch: 82 loss: 0.7725 accuracy: 0.7492 val_loss: 0.5660 val_accuracy: 0.9095
Epoch: 83 loss: 0.7872 accuracy: 0.7356 val_loss: 0.6137 val_accuracy: 0.9095
Epoch: 84 loss: 0.7682 accuracy: 0.7513 val_loss: 0.6198 val_accuracy: 0.9095
Epoch: 85 loss: 0.7635 accuracy: 0.7510 val_loss: 0.5758 val_accuracy: 0.9095
Epoch: 86 loss: 0.7786 accuracy: 0.7392 val_loss: 0.5674 val_accuracy: 0.9095
Epoch: 87 loss: 0.7558 accuracy: 0.7560 val_loss: 0.5811 val_accuracy: 0.9095

Epoch 00087: ReduceLROnPlateau reducing learning rate to 2.09715188248083e-05.
Epoch: 88 loss: 0.7698 accuracy: 0.7424 val_loss: 0.5899 val_accuracy: 0.9095
Epoch: 89 loss: 0.7540 accuracy: 0.7566 val_loss: 0.5623 val_accuracy: 0.9095
Epoch: 90 loss: 0.7633 accuracy: 0.7450 val_loss: 0.5526 val_accuracy: 0.9095
Epoch: 91 loss: 0.7613 accuracy: 0.7450 val_loss: 0.5601 val_accuracy: 0.9095
Epoch: 92 loss: 0.7731 accuracy: 0.7359 val_loss: 0.5772 val_accuracy: 0.9095
Epoch: 93 loss: 0.7516 accuracy: 0.7505 val_loss: 0.5619 val_accuracy: 0.9095
Epoch: 94 loss: 0.7607 accuracy: 0.7412 val_loss: 0.5364 val_accuracy: 0.9095
Epoch: 95 loss: 0.7482 accuracy: 0.7525 val_loss: 0.5415 val_accuracy: 0.9095
Epoch: 96 loss: 0.7535 accuracy: 0.7465 val_loss: 0.5441 val_accuracy: 0.9095
Epoch: 97 loss: 0.7583 accuracy: 0.7409 val_loss: 0.5535 val_accuracy: 0.9095
Epoch: 98 loss: 0.7454 accuracy: 0.7500 val_loss: 0.5724 val_accuracy: 0.9095
Epoch: 99 loss: 0.7563 accuracy: 0.7404 val_loss: 0.5632 val_accuracy: 0.9095

Epoch 00099: ReduceLROnPlateau reducing learning rate to 1.6777214477770033e-05.
Epoch: 100 loss: 0.7473 accuracy: 0.7462 val_loss: 0.5732 val_accuracy: 0.9095
End of augmented training
Finish
Job ended!
