Thu 02 May 2024 02:53:31 PM EDT
Python 3.9.7
nvcc: NVIDIA (R) Cuda compiler driver
Copyright (c) 2005-2019 NVIDIA Corporation
Built on Sun_Jul_28_19:07:16_PDT_2019
Cuda compilation tools, release 10.1, V10.1.243
My SLURM_ARRAY_TASK_ID: 
DB: ['KaggleMB']
IMG_SIZE: [384, 384]
CLASSIFIER: ResNet152
JOB_INDEX: None
Start training augmented images
Combining...
Combining 1th db out of 1 dbs
Stacking data
Combining complete
Model: "sequential"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
resnet152 (Functional)       (None, 2048)              58370944  
_________________________________________________________________
dense (Dense)                (None, 512)               1049088   
_________________________________________________________________
dropout (Dropout)            (None, 512)               0         
_________________________________________________________________
batch_normalization (BatchNo (None, 512)               2048      
_________________________________________________________________
dense_1 (Dense)              (None, 256)               131328    
_________________________________________________________________
batch_normalization_1 (Batch (None, 256)               1024      
_________________________________________________________________
dense_2 (Dense)              (None, 2)                 514       
=================================================================
Total params: 59,554,946
Trainable params: 1,182,466
Non-trainable params: 58,372,480
_________________________________________________________________
Fitting KaggleMB_aug_ResNet152_384h_384w_None model...
model_name: KaggleMB_aug_ResNet152_384h_384w_None
Epoch: 1 loss: 1.4192 accuracy: 0.5568 val_loss: 1.1362 val_accuracy: 0.5739
Epoch: 2 loss: 1.1820 accuracy: 0.6176 val_loss: 1.0618 val_accuracy: 0.7121
Epoch: 3 loss: 1.0025 accuracy: 0.6619 val_loss: 1.1514 val_accuracy: 0.4261
Epoch: 4 loss: 0.9420 accuracy: 0.6580 val_loss: 0.9769 val_accuracy: 0.4261
Epoch: 5 loss: 0.8745 accuracy: 0.6841 val_loss: 1.0108 val_accuracy: 0.4261
Epoch: 6 loss: 0.8507 accuracy: 0.6781 val_loss: 0.8647 val_accuracy: 0.5758
Epoch: 7 loss: 0.8585 accuracy: 0.6452 val_loss: 1.0728 val_accuracy: 0.5739
Epoch: 8 loss: 0.8538 accuracy: 0.6301 val_loss: 1.3700 val_accuracy: 0.5739
Epoch: 9 loss: 0.8332 accuracy: 0.6500 val_loss: 1.5014 val_accuracy: 0.5739
Epoch: 10 loss: 0.7971 accuracy: 0.6713 val_loss: 1.8786 val_accuracy: 0.5739
Epoch: 11 loss: 0.7689 accuracy: 0.6821 val_loss: 1.5936 val_accuracy: 0.5758

Epoch 00011: ReduceLROnPlateau reducing learning rate to 7.999999797903001e-05.
Epoch: 12 loss: 0.7417 accuracy: 0.6980 val_loss: 1.0734 val_accuracy: 0.5985
Epoch: 13 loss: 0.7499 accuracy: 0.6909 val_loss: 1.5013 val_accuracy: 0.5777
Epoch: 14 loss: 0.7284 accuracy: 0.7142 val_loss: 0.7129 val_accuracy: 0.7670
Epoch: 15 loss: 0.7323 accuracy: 0.7088 val_loss: 0.7674 val_accuracy: 0.6591
Epoch: 16 loss: 0.7248 accuracy: 0.7085 val_loss: 1.2418 val_accuracy: 0.5966
Epoch: 17 loss: 0.7308 accuracy: 0.6935 val_loss: 0.7116 val_accuracy: 0.6610
Epoch: 18 loss: 0.7312 accuracy: 0.6824 val_loss: 1.1698 val_accuracy: 0.5909
Epoch: 19 loss: 0.7522 accuracy: 0.6562 val_loss: 1.1839 val_accuracy: 0.5909
Epoch: 20 loss: 0.7203 accuracy: 0.7017 val_loss: 0.7903 val_accuracy: 0.6288
Epoch: 21 loss: 0.6660 accuracy: 0.7449 val_loss: 0.9439 val_accuracy: 0.6004
Epoch: 22 loss: 0.6917 accuracy: 0.7193 val_loss: 0.7464 val_accuracy: 0.6439

Epoch 00022: ReduceLROnPlateau reducing learning rate to 6.399999838322402e-05.
Epoch: 23 loss: 0.6717 accuracy: 0.7435 val_loss: 0.8515 val_accuracy: 0.6117
Epoch: 24 loss: 0.6750 accuracy: 0.7318 val_loss: 0.6706 val_accuracy: 0.7008
Epoch: 25 loss: 0.6658 accuracy: 0.7398 val_loss: 0.7476 val_accuracy: 0.7102
Epoch: 26 loss: 0.6551 accuracy: 0.7563 val_loss: 0.6556 val_accuracy: 0.7273
Epoch: 27 loss: 0.6839 accuracy: 0.7216 val_loss: 0.7242 val_accuracy: 0.6477
Epoch: 28 loss: 0.6485 accuracy: 0.7588 val_loss: 1.1208 val_accuracy: 0.6042
Epoch: 29 loss: 0.6621 accuracy: 0.7446 val_loss: 0.6991 val_accuracy: 0.6553
Epoch: 30 loss: 0.6218 accuracy: 0.7730 val_loss: 0.6772 val_accuracy: 0.7178
Epoch: 31 loss: 0.6221 accuracy: 0.7739 val_loss: 0.7686 val_accuracy: 0.6572

Epoch 00031: ReduceLROnPlateau reducing learning rate to 5.119999987073243e-05.
Epoch: 32 loss: 0.5941 accuracy: 0.7878 val_loss: 0.6813 val_accuracy: 0.6989
Epoch: 33 loss: 0.5825 accuracy: 0.7926 val_loss: 0.6547 val_accuracy: 0.7311
Epoch: 34 loss: 0.5901 accuracy: 0.7957 val_loss: 0.8408 val_accuracy: 0.6269
Epoch: 35 loss: 0.6376 accuracy: 0.7673 val_loss: 0.7009 val_accuracy: 0.7311
Epoch: 36 loss: 0.6231 accuracy: 0.7685 val_loss: 0.6304 val_accuracy: 0.7576
Epoch: 37 loss: 0.6108 accuracy: 0.7818 val_loss: 0.8617 val_accuracy: 0.6439
Epoch: 38 loss: 0.6057 accuracy: 0.7778 val_loss: 0.6531 val_accuracy: 0.7652
Epoch: 39 loss: 0.5936 accuracy: 0.7858 val_loss: 0.6240 val_accuracy: 0.7614
Epoch: 40 loss: 0.5844 accuracy: 0.7804 val_loss: 0.6319 val_accuracy: 0.7595
Epoch: 41 loss: 0.5801 accuracy: 0.7864 val_loss: 0.7154 val_accuracy: 0.6932
Epoch: 42 loss: 0.6102 accuracy: 0.7662 val_loss: 0.9401 val_accuracy: 0.5170
Epoch: 43 loss: 0.5822 accuracy: 0.7866 val_loss: 0.6321 val_accuracy: 0.7424
Epoch: 44 loss: 0.5897 accuracy: 0.7812 val_loss: 0.6421 val_accuracy: 0.7670

Epoch 00044: ReduceLROnPlateau reducing learning rate to 4.0960000478662555e-05.
Epoch: 45 loss: 0.5703 accuracy: 0.7824 val_loss: 0.6302 val_accuracy: 0.7424
Epoch: 46 loss: 0.5892 accuracy: 0.7707 val_loss: 0.6092 val_accuracy: 0.7708
Epoch: 47 loss: 0.5625 accuracy: 0.7923 val_loss: 0.9312 val_accuracy: 0.6364
Epoch: 48 loss: 0.5806 accuracy: 0.7801 val_loss: 0.6030 val_accuracy: 0.7841
Epoch: 49 loss: 0.5582 accuracy: 0.8028 val_loss: 0.6837 val_accuracy: 0.7538
Epoch: 50 loss: 0.5672 accuracy: 0.7895 val_loss: 0.6135 val_accuracy: 0.7614
Epoch: 51 loss: 0.5659 accuracy: 0.7884 val_loss: 0.6016 val_accuracy: 0.7689
Epoch: 52 loss: 0.5472 accuracy: 0.8065 val_loss: 0.6322 val_accuracy: 0.7443
Epoch: 53 loss: 0.5633 accuracy: 0.7849 val_loss: 0.6798 val_accuracy: 0.7462
Epoch: 54 loss: 0.5516 accuracy: 0.8000 val_loss: 0.5902 val_accuracy: 0.7860
Epoch: 55 loss: 0.5596 accuracy: 0.7886 val_loss: 0.6358 val_accuracy: 0.7367
Epoch: 56 loss: 0.5422 accuracy: 0.7994 val_loss: 0.7156 val_accuracy: 0.6951
Epoch: 57 loss: 0.5543 accuracy: 0.7920 val_loss: 0.7508 val_accuracy: 0.6761
Epoch: 58 loss: 0.5539 accuracy: 0.7875 val_loss: 0.5822 val_accuracy: 0.7898
Epoch: 59 loss: 0.5564 accuracy: 0.7980 val_loss: 0.6177 val_accuracy: 0.7292
Epoch: 60 loss: 0.5548 accuracy: 0.7952 val_loss: 0.6057 val_accuracy: 0.7405
Epoch: 61 loss: 0.5448 accuracy: 0.7963 val_loss: 0.5998 val_accuracy: 0.7633
Epoch: 62 loss: 0.5588 accuracy: 0.7884 val_loss: 0.5891 val_accuracy: 0.7803
Epoch: 63 loss: 0.5431 accuracy: 0.8028 val_loss: 0.5820 val_accuracy: 0.7727
Epoch: 64 loss: 0.5332 accuracy: 0.8057 val_loss: 0.6321 val_accuracy: 0.7595
Epoch: 65 loss: 0.5361 accuracy: 0.7943 val_loss: 0.7176 val_accuracy: 0.7064
Epoch: 66 loss: 0.5405 accuracy: 0.7952 val_loss: 0.6062 val_accuracy: 0.7367
Epoch: 67 loss: 0.5400 accuracy: 0.7986 val_loss: 0.8538 val_accuracy: 0.6477
Epoch: 68 loss: 0.5428 accuracy: 0.7974 val_loss: 0.6564 val_accuracy: 0.6913

Epoch 00068: ReduceLROnPlateau reducing learning rate to 3.2767999800853435e-05.
Epoch: 69 loss: 0.5401 accuracy: 0.7974 val_loss: 0.5984 val_accuracy: 0.7386
Epoch: 70 loss: 0.5242 accuracy: 0.8014 val_loss: 0.6071 val_accuracy: 0.7235
Epoch: 71 loss: 0.5215 accuracy: 0.8062 val_loss: 0.5712 val_accuracy: 0.7822
Epoch: 72 loss: 0.5433 accuracy: 0.7946 val_loss: 0.6501 val_accuracy: 0.7197
Epoch: 73 loss: 0.5468 accuracy: 0.7943 val_loss: 0.6457 val_accuracy: 0.7159
Epoch: 74 loss: 0.5420 accuracy: 0.7932 val_loss: 0.8098 val_accuracy: 0.6496
Epoch: 75 loss: 0.5280 accuracy: 0.8091 val_loss: 0.5533 val_accuracy: 0.7860
Epoch: 76 loss: 0.5558 accuracy: 0.7818 val_loss: 0.7458 val_accuracy: 0.5795
Epoch: 77 loss: 0.5388 accuracy: 0.7918 val_loss: 0.5529 val_accuracy: 0.7917
Epoch: 78 loss: 0.5291 accuracy: 0.8011 val_loss: 0.7313 val_accuracy: 0.6799
Epoch: 79 loss: 0.5318 accuracy: 0.7952 val_loss: 0.5586 val_accuracy: 0.7955
Epoch: 80 loss: 0.5245 accuracy: 0.8108 val_loss: 0.6982 val_accuracy: 0.6856
Epoch: 81 loss: 0.5279 accuracy: 0.8034 val_loss: 0.7383 val_accuracy: 0.6648
Epoch: 82 loss: 0.5224 accuracy: 0.8011 val_loss: 0.6406 val_accuracy: 0.7235

Epoch 00082: ReduceLROnPlateau reducing learning rate to 2.6214399258606137e-05.
Epoch: 83 loss: 0.5379 accuracy: 0.7960 val_loss: 0.9558 val_accuracy: 0.6402
Epoch: 84 loss: 0.5276 accuracy: 0.8028 val_loss: 0.6424 val_accuracy: 0.7178
Epoch: 85 loss: 0.5202 accuracy: 0.8011 val_loss: 0.5679 val_accuracy: 0.7652
Epoch: 86 loss: 0.5052 accuracy: 0.8114 val_loss: 0.6019 val_accuracy: 0.7311
Epoch: 87 loss: 0.5083 accuracy: 0.8017 val_loss: 0.5521 val_accuracy: 0.7784
Epoch: 88 loss: 0.5266 accuracy: 0.7983 val_loss: 1.2607 val_accuracy: 0.4261
Epoch: 89 loss: 0.5162 accuracy: 0.8114 val_loss: 0.5714 val_accuracy: 0.7973
Epoch: 90 loss: 0.5218 accuracy: 0.7949 val_loss: 0.5948 val_accuracy: 0.7292
Epoch: 91 loss: 0.5154 accuracy: 0.8080 val_loss: 1.0572 val_accuracy: 0.6250
Epoch: 92 loss: 0.4912 accuracy: 0.8236 val_loss: 0.5454 val_accuracy: 0.7898
Epoch: 93 loss: 0.5073 accuracy: 0.8102 val_loss: 0.5939 val_accuracy: 0.7273
Epoch: 94 loss: 0.5007 accuracy: 0.8099 val_loss: 0.7180 val_accuracy: 0.6667
Epoch: 95 loss: 0.5114 accuracy: 0.8060 val_loss: 0.5693 val_accuracy: 0.7405
Epoch: 96 loss: 0.5160 accuracy: 0.7994 val_loss: 0.6148 val_accuracy: 0.7273
Epoch: 97 loss: 0.4893 accuracy: 0.8179 val_loss: 0.5588 val_accuracy: 0.7614

Epoch 00097: ReduceLROnPlateau reducing learning rate to 2.09715188248083e-05.
Epoch: 98 loss: 0.5040 accuracy: 0.8062 val_loss: 0.6343 val_accuracy: 0.7140
Epoch: 99 loss: 0.4946 accuracy: 0.8179 val_loss: 0.7448 val_accuracy: 0.6856
Epoch: 100 loss: 0.5047 accuracy: 0.8040 val_loss: 0.5630 val_accuracy: 0.7595
End of augmented training
Finish
Job ended!
