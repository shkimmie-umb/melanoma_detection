Thu 02 May 2024 02:31:52 PM EDT
Python 3.9.7
nvcc: NVIDIA (R) Cuda compiler driver
Copyright (c) 2005-2019 NVIDIA Corporation
Built on Sun_Jul_28_19:07:16_PDT_2019
Cuda compilation tools, release 10.1, V10.1.243
My SLURM_ARRAY_TASK_ID: 
DB: ['ISIC2016', 'PAD_UFES_20', 'MEDNODE', 'KaggleMB']
IMG_SIZE: [384, 384]
CLASSIFIER: ResNet152
JOB_INDEX: None
Start training augmented images
Combining...
Combining 1th db out of 4 dbs
Combining 2th db out of 4 dbs
Combining 3th db out of 4 dbs
Combining 4th db out of 4 dbs
Stacking data
Combining complete
Model: "sequential"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
resnet152 (Functional)       (None, 2048)              58370944  
_________________________________________________________________
dense (Dense)                (None, 512)               1049088   
_________________________________________________________________
dropout (Dropout)            (None, 512)               0         
_________________________________________________________________
batch_normalization (BatchNo (None, 512)               2048      
_________________________________________________________________
dense_1 (Dense)              (None, 256)               131328    
_________________________________________________________________
batch_normalization_1 (Batch (None, 256)               1024      
_________________________________________________________________
dense_2 (Dense)              (None, 2)                 514       
=================================================================
Total params: 59,554,946
Trainable params: 1,182,466
Non-trainable params: 58,372,480
_________________________________________________________________
Fitting ISIC2016+PAD_UFES_20+MEDNODE+KaggleMB_aug_ResNet152_384h_384w_None model...
model_name: ISIC2016+PAD_UFES_20+MEDNODE+KaggleMB_aug_ResNet152_384h_384w_None
Epoch: 1 loss: 1.3977 accuracy: 0.5163 val_loss: 0.9592 val_accuracy: 0.7621
Epoch: 2 loss: 1.1348 accuracy: 0.5287 val_loss: 0.9419 val_accuracy: 0.7388
Epoch: 3 loss: 1.0242 accuracy: 0.5291 val_loss: 0.9711 val_accuracy: 0.2371
Epoch: 4 loss: 0.9760 accuracy: 0.5351 val_loss: 0.7376 val_accuracy: 0.7621
Epoch: 5 loss: 0.9362 accuracy: 0.5418 val_loss: 0.7192 val_accuracy: 0.7621
Epoch: 6 loss: 0.9227 accuracy: 0.5319 val_loss: 0.7202 val_accuracy: 0.7621
Epoch: 7 loss: 0.9101 accuracy: 0.5366 val_loss: 0.6950 val_accuracy: 0.7621
Epoch: 8 loss: 0.8861 accuracy: 0.5479 val_loss: 0.7755 val_accuracy: 0.7621
Epoch: 9 loss: 0.8828 accuracy: 0.5342 val_loss: 0.6867 val_accuracy: 0.7612
Epoch: 10 loss: 0.8604 accuracy: 0.5494 val_loss: 0.6833 val_accuracy: 0.7621
Epoch: 11 loss: 0.8767 accuracy: 0.5275 val_loss: 0.7129 val_accuracy: 0.7621
Epoch: 12 loss: 0.8509 accuracy: 0.5405 val_loss: 0.7364 val_accuracy: 0.7621
Epoch: 13 loss: 0.8463 accuracy: 0.5338 val_loss: 0.7104 val_accuracy: 0.7621
Epoch: 14 loss: 0.8325 accuracy: 0.5421 val_loss: 0.6735 val_accuracy: 0.7621
Epoch: 15 loss: 0.8262 accuracy: 0.5462 val_loss: 0.7534 val_accuracy: 0.7621
Epoch: 16 loss: 0.8208 accuracy: 0.5541 val_loss: 0.6822 val_accuracy: 0.7621
Epoch: 17 loss: 0.8126 accuracy: 0.5557 val_loss: 0.6746 val_accuracy: 0.7621
Epoch: 18 loss: 0.8085 accuracy: 0.5596 val_loss: 0.6638 val_accuracy: 0.7621
Epoch: 19 loss: 0.8024 accuracy: 0.5640 val_loss: 0.6848 val_accuracy: 0.7621
Epoch: 20 loss: 0.7907 accuracy: 0.5931 val_loss: 0.6722 val_accuracy: 0.7621
Epoch: 21 loss: 0.7815 accuracy: 0.6075 val_loss: 0.6787 val_accuracy: 0.7621
Epoch: 22 loss: 0.7809 accuracy: 0.5917 val_loss: 0.8882 val_accuracy: 0.2379
Epoch: 23 loss: 0.7895 accuracy: 0.5712 val_loss: 0.6539 val_accuracy: 0.7621
Epoch: 24 loss: 0.7855 accuracy: 0.5681 val_loss: 0.6560 val_accuracy: 0.7621
Epoch: 25 loss: 0.7620 accuracy: 0.6044 val_loss: 0.7290 val_accuracy: 0.7621
Epoch: 26 loss: 0.7810 accuracy: 0.5773 val_loss: 0.7741 val_accuracy: 0.7629
Epoch: 27 loss: 0.7828 accuracy: 0.5698 val_loss: 0.6502 val_accuracy: 0.7621
Epoch: 28 loss: 0.7790 accuracy: 0.5693 val_loss: 0.6812 val_accuracy: 0.7621
Epoch: 29 loss: 0.7884 accuracy: 0.5541 val_loss: 0.6453 val_accuracy: 0.7621
Epoch: 30 loss: 0.7778 accuracy: 0.5697 val_loss: 0.6390 val_accuracy: 0.7621
Epoch: 31 loss: 0.7734 accuracy: 0.5717 val_loss: 0.6366 val_accuracy: 0.7621
Epoch: 32 loss: 0.7770 accuracy: 0.5618 val_loss: 0.6646 val_accuracy: 0.7621
Epoch: 33 loss: 0.7780 accuracy: 0.5493 val_loss: 2.8550 val_accuracy: 0.2379
Epoch: 34 loss: 0.8135 accuracy: 0.5334 val_loss: 1.1933 val_accuracy: 0.2379
Epoch: 35 loss: 0.7948 accuracy: 0.5345 val_loss: 0.8590 val_accuracy: 0.2379
Epoch: 36 loss: 0.7824 accuracy: 0.5374 val_loss: 0.6549 val_accuracy: 0.7621

Epoch 00036: ReduceLROnPlateau reducing learning rate to 7.999999797903001e-05.
Epoch: 37 loss: 0.7685 accuracy: 0.5578 val_loss: 0.6992 val_accuracy: 0.7621
Epoch: 38 loss: 0.7673 accuracy: 0.5597 val_loss: 0.6309 val_accuracy: 0.7621
Epoch: 39 loss: 0.7640 accuracy: 0.5640 val_loss: 0.6220 val_accuracy: 0.7621
Epoch: 40 loss: 0.7630 accuracy: 0.5630 val_loss: 0.6661 val_accuracy: 0.7621
Epoch: 41 loss: 0.7584 accuracy: 0.5700 val_loss: 1.8925 val_accuracy: 0.2379
Epoch: 42 loss: 0.7573 accuracy: 0.5650 val_loss: 0.6532 val_accuracy: 0.7621
Epoch: 43 loss: 0.7529 accuracy: 0.5744 val_loss: 0.6258 val_accuracy: 0.7621
Epoch: 44 loss: 0.7541 accuracy: 0.5646 val_loss: 0.6144 val_accuracy: 0.7621
Epoch: 45 loss: 0.7526 accuracy: 0.5652 val_loss: 0.6577 val_accuracy: 0.7621
Epoch: 46 loss: 0.7503 accuracy: 0.5661 val_loss: 0.6111 val_accuracy: 0.7621
Epoch: 47 loss: 0.7481 accuracy: 0.5686 val_loss: 0.6098 val_accuracy: 0.7621
Epoch: 48 loss: 0.7413 accuracy: 0.5704 val_loss: 0.6292 val_accuracy: 0.7621
Epoch: 49 loss: 0.7385 accuracy: 0.5781 val_loss: 0.6194 val_accuracy: 0.7621
Epoch: 50 loss: 0.7463 accuracy: 0.5600 val_loss: 0.6136 val_accuracy: 0.7621
Epoch: 51 loss: 0.7451 accuracy: 0.5578 val_loss: 0.6457 val_accuracy: 0.7621
Epoch: 52 loss: 0.7412 accuracy: 0.5636 val_loss: 0.8355 val_accuracy: 0.2379

Epoch 00052: ReduceLROnPlateau reducing learning rate to 6.399999838322402e-05.
Epoch: 53 loss: 0.7360 accuracy: 0.5744 val_loss: 0.6145 val_accuracy: 0.7621
Epoch: 54 loss: 0.7338 accuracy: 0.5768 val_loss: 0.6224 val_accuracy: 0.7621
Epoch: 55 loss: 0.7389 accuracy: 0.5646 val_loss: 0.6387 val_accuracy: 0.7612
Epoch: 56 loss: 0.7334 accuracy: 0.5698 val_loss: 0.5966 val_accuracy: 0.7621
Epoch: 57 loss: 0.7332 accuracy: 0.5657 val_loss: 0.5969 val_accuracy: 0.7621
Epoch: 58 loss: 0.7278 accuracy: 0.5769 val_loss: 0.5937 val_accuracy: 0.7621
Epoch: 59 loss: 0.7280 accuracy: 0.5784 val_loss: 0.6251 val_accuracy: 0.7621
Epoch: 60 loss: 0.7214 accuracy: 0.5888 val_loss: 0.6009 val_accuracy: 0.7621
Epoch: 61 loss: 0.7312 accuracy: 0.5672 val_loss: 0.5922 val_accuracy: 0.7621
Epoch: 62 loss: 0.7288 accuracy: 0.5638 val_loss: 3.0256 val_accuracy: 0.2379
Epoch: 63 loss: 0.7222 accuracy: 0.5756 val_loss: 0.6016 val_accuracy: 0.7604
Epoch: 64 loss: 0.7170 accuracy: 0.5827 val_loss: 0.5933 val_accuracy: 0.7621
Epoch: 65 loss: 0.7171 accuracy: 0.5753 val_loss: 0.5875 val_accuracy: 0.7621
Epoch: 66 loss: 0.7125 accuracy: 0.5849 val_loss: 0.5923 val_accuracy: 0.7621
Epoch: 67 loss: 0.7183 accuracy: 0.5760 val_loss: 0.6461 val_accuracy: 0.7621
Epoch: 68 loss: 0.6913 accuracy: 0.6207 val_loss: 0.5930 val_accuracy: 0.7621
Epoch: 69 loss: 0.6874 accuracy: 0.6186 val_loss: 4.0026 val_accuracy: 0.2379
Epoch: 70 loss: 0.6995 accuracy: 0.5975 val_loss: 0.6084 val_accuracy: 0.7621

Epoch 00070: ReduceLROnPlateau reducing learning rate to 5.119999987073243e-05.
Epoch: 71 loss: 0.6747 accuracy: 0.6333 val_loss: 0.5901 val_accuracy: 0.7621
Epoch: 72 loss: 0.6714 accuracy: 0.6380 val_loss: 0.5768 val_accuracy: 0.7621
Epoch: 73 loss: 0.6686 accuracy: 0.6393 val_loss: 0.5941 val_accuracy: 0.7646
Epoch: 74 loss: 0.6593 accuracy: 0.6446 val_loss: 0.8802 val_accuracy: 0.3170
Epoch: 75 loss: 0.6665 accuracy: 0.6388 val_loss: 0.5904 val_accuracy: 0.7604
Epoch: 76 loss: 0.6571 accuracy: 0.6486 val_loss: 0.5840 val_accuracy: 0.7662
Epoch: 77 loss: 0.6513 accuracy: 0.6517 val_loss: 0.5887 val_accuracy: 0.7629

Epoch 00077: ReduceLROnPlateau reducing learning rate to 4.0960000478662555e-05.
Epoch: 78 loss: 0.6494 accuracy: 0.6581 val_loss: 0.5883 val_accuracy: 0.7621
Epoch: 79 loss: 0.6422 accuracy: 0.6641 val_loss: 0.5735 val_accuracy: 0.7671
Epoch: 80 loss: 0.6552 accuracy: 0.6466 val_loss: 0.5668 val_accuracy: 0.7646
Epoch: 81 loss: 0.6453 accuracy: 0.6556 val_loss: 0.6159 val_accuracy: 0.7354
Epoch: 82 loss: 0.6426 accuracy: 0.6601 val_loss: 0.5416 val_accuracy: 0.7712
Epoch: 83 loss: 0.6414 accuracy: 0.6613 val_loss: 0.5548 val_accuracy: 0.7637
Epoch: 84 loss: 0.6437 accuracy: 0.6621 val_loss: 0.6146 val_accuracy: 0.7629
Epoch: 85 loss: 0.6423 accuracy: 0.6615 val_loss: 0.5625 val_accuracy: 0.7662
Epoch: 86 loss: 0.6420 accuracy: 0.6562 val_loss: 0.6137 val_accuracy: 0.7612
Epoch: 87 loss: 0.6383 accuracy: 0.6688 val_loss: 0.5901 val_accuracy: 0.7621

Epoch 00087: ReduceLROnPlateau reducing learning rate to 3.2767999800853435e-05.
Epoch: 88 loss: 0.6341 accuracy: 0.6667 val_loss: 0.5586 val_accuracy: 0.7629
Epoch: 89 loss: 0.6299 accuracy: 0.6728 val_loss: 0.5838 val_accuracy: 0.7629
Epoch: 90 loss: 0.6293 accuracy: 0.6664 val_loss: 0.5818 val_accuracy: 0.7629
Epoch: 91 loss: 0.6292 accuracy: 0.6688 val_loss: 0.6049 val_accuracy: 0.7612
Epoch: 92 loss: 0.6386 accuracy: 0.6579 val_loss: 0.5473 val_accuracy: 0.7662

Epoch 00092: ReduceLROnPlateau reducing learning rate to 2.6214399258606137e-05.
End of augmented training
Finish
Job ended!
